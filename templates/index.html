<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <title>FinanZen ‚Äì Controle Inteligente</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/512/1183/1183672.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <div class="glass-container">
    <div class="header">
      <h1>üí∞ Painel Financeiro</h1>
      <button id="toggle-theme" class="botao-tema">üåô Modo Escuro</button>
    </div>

    <form action="/lancamento" method="post" class="formulario">
      <div class="campo-form">
        <label for="data">Data</label>
        <input type="date" name="data" id="data" required />
      </div>

      <div class="campo-form">
        <label for="tipo">Tipo</label>
        <select name="tipo" id="tipo" required>
          <option value="entrada">Entrada</option>
          <option value="saida">Sa√≠da</option>
          <option value="salario">Sal√°rio</option>
          <option value="recebimento">Recebimento</option>
          <option value="divida">D√≠vida</option>
          <option value="conta">Conta Fixa</option>
        </select>
      </div>

      <div class="campo-form">
        <label for="descricao">Descri√ß√£o</label>
        <input type="text" name="descricao" id="descricao" required />
      </div>

      <div class="campo-form">
        <label for="valor">Valor</label>
        <input type="number" step="0.01" name="valor" id="valor" required placeholder="Ex: 199.90" />
      </div>

      <div class="campo-form">
        <label for="categoria">Categoria</label>
        <select name="categoria" id="categoria">
          <option value="">Selecione</option>
          <option value="Moradia">Moradia</option>
          <option value="Alimenta√ß√£o">Alimenta√ß√£o</option>
          <option value="Transporte">Transporte</option>
          <option value="Educa√ß√£o">Educa√ß√£o</option>
          <option value="Lazer">Lazer</option>
          <option value="Sa√∫de">Sa√∫de</option>
          <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
          <option value="Outros">Outros</option>
        </select>
      </div>

      <div class="campo-form">
        <label for="vencimento">Vencimento</label>
        <input type="date" name="vencimento" id="vencimento" />
      </div>

      <div class="campo-form">
        <label for="parcelas">Parcelas</label>
        <select name="parcelas" id="parcelas">
          {% for i in range(1, 13) %}
          <option value="{{ i }}">{{ i }}x</option>
          {% endfor %}
        </select>
      </div>

      <div class="checkbox-form">
        <input type="checkbox" name="recorrente" id="recorrente" />
        <label for="recorrente">Recorrente</label>
      </div>

      <button type="submit" class="botao-principal">Adicionar</button>
    </form>

    <div class="valor-boxes">
      <div class="valor-box">Entradas: R$ {{ '%.2f'|format(entrada) }}</div>
      <div class="valor-box">Sa√≠das: R$ {{ '%.2f'|format(saida) }}</div>
      <div class="valor-box">Saldo: R$ {{ '%.2f'|format(saldo) }}</div>
    </div>

    <canvas id="graficoResumo" height="100"></canvas>

    <div class="glass-card">
      <h2>Lan√ßamentos</h2>
      <table class="tabela-glass">
        <thead>
          <tr>
            <th>Data</th>
            <th>Tipo</th>
            <th>Descri√ß√£o</th>
            <th>Valor</th>
            <th>Categoria</th>
            <th>Vencimento</th>
            <th>Recorrente</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody>
          {% for item in dados %}
          <tr>
            <td>{{ item.data }}</td>
            <td>{{ item.tipo }}</td>
            <td>{{ item.descricao }}</td>
            <td>R$ {{ '%.2f'|format(item.valor | float) }}</td>
            <td>{{ item.categoria }}</td>
            <td>{{ item.vencimento or '' }}</td>
            <td>{{ 'Sim' if item.recorrente else 'N√£o' }}</td>
            <td>
              <button class="editar" data-id="{{ item.id }}">‚úèÔ∏è</button>
              <button class="excluir" data-id="{{ item.id }}">üóëÔ∏è</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {% if contas_fixas %}
    <div class="glass-card">
      <h2>üìå Contas Fixas Ativas</h2>
      <ul class="lista-destaque">
        {% for conta in contas_fixas %}
        <li>{{ conta.descricao }} - R$ {{ '%.2f'|format(conta.valor) }} ({{ conta.categoria }}) - todo dia {{ conta.dia_vencimento }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    {% if parcelas_futuras %}
    <div class="glass-card">
      <h2>üí≥ Parcelamentos Futuros</h2>
      <ul class="lista-destaque">
        {% for p in parcelas_futuras %}
        <li>{{ p.descricao }} - Parcela {{ p.parcela_atual }}/{{ p.total_parcelas }} - R$ {{ '%.2f'|format(p.valor) }} (vence em {{ p.vencimento }})</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>

  <script>
    const entrada = {{ entrada | default(0.0) | float }};
    const saida = {{ saida | default(0.0) | float }};
    const saldo = {{ saldo | default(0.0) | float }};
  </script>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script src="{{ url_for('static', filename='form.js') }}"></script>
  <script src="{{ url_for('static', filename='lancamentos.js') }}"></script>
</body>
</html>
